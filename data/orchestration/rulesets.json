{
  "activeRuleSetId": "default",
  "ruleSets": {
    "default": {
      "id": "default",
      "name": "Ghost Evaluator v15.1 Rules",
      "rules": [
        {
          "id": "RULE-ACT-001",
          "name": "Standard Pattern Activation (70% threshold)",
          "description": "Activate pattern when single observation result >= 70% profit",
          "category": "activation",
          "enabled": true,
          "priority": 1,
          "conditions": [
            {
              "field": "pattern.state",
              "operator": "eq",
              "value": "observing"
            },
            {
              "field": "result.profit",
              "operator": "gte",
              "value": 70,
              "logic": "and"
            }
          ],
          "actions": [
            {
              "type": "set",
              "target": "pattern.state",
              "value": "active"
            }
          ],
          "metadata": {
            "version": 1,
            "createdAt": "2025-12-05T23:45:35.097Z",
            "updatedAt": "2025-12-05T23:45:35.097Z",
            "author": "system",
            "notes": [
              "Standard activation threshold for most patterns"
            ],
            "testCoverage": 85
          }
        },
        {
          "id": "RULE-ACT-002",
          "name": "Cumulative Activation (100% threshold)",
          "description": "Activate pattern when cumulative observation profit >= 100%",
          "category": "activation",
          "enabled": true,
          "priority": 2,
          "conditions": [
            {
              "field": "pattern.state",
              "operator": "eq",
              "value": "observing"
            },
            {
              "field": "pattern.cumulativeProfit",
              "operator": "gte",
              "value": 100,
              "logic": "and"
            }
          ],
          "actions": [
            {
              "type": "set",
              "target": "pattern.state",
              "value": "active"
            }
          ],
          "metadata": {
            "version": 1,
            "createdAt": "2025-12-05T23:45:35.097Z",
            "updatedAt": "2025-12-05T23:45:35.097Z",
            "author": "system",
            "notes": [
              "Alternative activation through accumulated profit"
            ],
            "testCoverage": 80
          }
        },
        {
          "id": "RULE-ACT-003",
          "name": "ZZ Immediate Activation",
          "description": "ZZ pattern activates immediately on first detection",
          "category": "activation",
          "enabled": true,
          "priority": 0,
          "conditions": [
            {
              "field": "pattern.name",
              "operator": "eq",
              "value": "ZZ"
            },
            {
              "field": "pattern.state",
              "operator": "eq",
              "value": "observing",
              "logic": "and"
            }
          ],
          "actions": [
            {
              "type": "set",
              "target": "pattern.state",
              "value": "active"
            }
          ],
          "metadata": {
            "version": 1,
            "createdAt": "2025-12-05T23:45:35.097Z",
            "updatedAt": "2025-12-05T23:45:35.097Z",
            "author": "system",
            "notes": [
              "ZZ does not require 70% threshold"
            ],
            "testCoverage": 90
          }
        },
        {
          "id": "RULE-ACC-001",
          "name": "No Negative Accumulation",
          "description": "Pattern cumulative profit cannot go below 0",
          "category": "accumulation",
          "enabled": true,
          "priority": 1,
          "conditions": [
            {
              "field": "result.profit",
              "operator": "lt",
              "value": 0
            }
          ],
          "actions": [
            {
              "type": "reset",
              "target": "pattern.cumulativeProfit",
              "value": 0
            }
          ],
          "metadata": {
            "version": 1,
            "createdAt": "2025-12-05T23:45:35.097Z",
            "updatedAt": "2025-12-05T23:45:35.097Z",
            "author": "system",
            "notes": [
              "Prevents negative accumulation"
            ],
            "testCoverage": 95
          }
        },
        {
          "id": "RULE-ACC-002",
          "name": "Loss Transfer to Opposite",
          "description": "When pattern loses, transfer loss amount to opposite pattern",
          "category": "accumulation",
          "enabled": true,
          "priority": 2,
          "conditions": [
            {
              "field": "result.profit",
              "operator": "lt",
              "value": 0
            },
            {
              "field": "pattern.hasOpposite",
              "operator": "eq",
              "value": true,
              "logic": "and"
            }
          ],
          "actions": [
            {
              "type": "add",
              "target": "oppositePattern.cumulativeProfit",
              "value": "abs(result.profit)"
            }
          ],
          "metadata": {
            "version": 1,
            "createdAt": "2025-12-05T23:45:35.097Z",
            "updatedAt": "2025-12-05T23:45:35.097Z",
            "author": "system",
            "notes": [
              "Loss becomes gain for opposite pattern"
            ],
            "testCoverage": 90
          }
        },
        {
          "id": "RULE-SWT-001",
          "name": "ZZ to AntiZZ Switch",
          "description": "Switch from ZZ to AntiZZ when last run profit <= 0",
          "category": "switching",
          "enabled": true,
          "priority": 1,
          "conditions": [
            {
              "field": "pattern.name",
              "operator": "eq",
              "value": "ZZ"
            },
            {
              "field": "pattern.state",
              "operator": "eq",
              "value": "active",
              "logic": "and"
            },
            {
              "field": "pattern.lastRunProfit",
              "operator": "lte",
              "value": 0,
              "logic": "and"
            },
            {
              "field": "event",
              "operator": "eq",
              "value": "break",
              "logic": "and"
            }
          ],
          "actions": [
            {
              "type": "set",
              "target": "ZZ.state",
              "value": "observing"
            },
            {
              "type": "set",
              "target": "AntiZZ.state",
              "value": "active"
            }
          ],
          "metadata": {
            "version": 1,
            "createdAt": "2025-12-05T23:45:35.097Z",
            "updatedAt": "2025-12-05T23:45:35.097Z",
            "author": "system",
            "notes": [
              "Based on last run profitability, not all-time"
            ],
            "testCoverage": 85
          }
        },
        {
          "id": "RULE-SWT-002",
          "name": "AntiZZ to ZZ Switch",
          "description": "Switch from AntiZZ to ZZ when last run profit <= 0",
          "category": "switching",
          "enabled": true,
          "priority": 1,
          "conditions": [
            {
              "field": "pattern.name",
              "operator": "eq",
              "value": "AntiZZ"
            },
            {
              "field": "pattern.state",
              "operator": "eq",
              "value": "active",
              "logic": "and"
            },
            {
              "field": "pattern.lastRunProfit",
              "operator": "lte",
              "value": 0,
              "logic": "and"
            },
            {
              "field": "event",
              "operator": "eq",
              "value": "break",
              "logic": "and"
            }
          ],
          "actions": [
            {
              "type": "set",
              "target": "AntiZZ.state",
              "value": "observing"
            },
            {
              "type": "set",
              "target": "ZZ.state",
              "value": "active"
            }
          ],
          "metadata": {
            "version": 1,
            "createdAt": "2025-12-05T23:45:35.097Z",
            "updatedAt": "2025-12-05T23:45:35.097Z",
            "author": "system",
            "notes": [
              "Returns to ZZ when AntiZZ unprofitable"
            ],
            "testCoverage": 85
          }
        },
        {
          "id": "RULE-SWT-003",
          "name": "ZZ/AntiZZ Stay Active",
          "description": "ZZ/AntiZZ stays active when last run profit > 0",
          "category": "switching",
          "enabled": true,
          "priority": 0,
          "conditions": [
            {
              "field": "pattern.name",
              "operator": "in",
              "value": [
                "ZZ",
                "AntiZZ"
              ]
            },
            {
              "field": "pattern.state",
              "operator": "eq",
              "value": "active",
              "logic": "and"
            },
            {
              "field": "pattern.lastRunProfit",
              "operator": "gt",
              "value": 0,
              "logic": "and"
            },
            {
              "field": "event",
              "operator": "eq",
              "value": "break",
              "logic": "and"
            }
          ],
          "actions": [
            {
              "type": "reset",
              "target": "pattern.lastRunProfit",
              "value": 0
            }
          ],
          "metadata": {
            "version": 1,
            "createdAt": "2025-12-05T23:45:35.097Z",
            "updatedAt": "2025-12-05T23:45:35.097Z",
            "author": "system",
            "notes": [
              "Profitable patterns stay active"
            ],
            "testCoverage": 80
          }
        },
        {
          "id": "RULE-RSK-001",
          "name": "Cooldown After 2 Losses",
          "description": "Enter 3-block cooldown after 2 consecutive losses",
          "category": "cooldown",
          "enabled": true,
          "priority": 1,
          "conditions": [
            {
              "field": "trade.consecutiveLosses",
              "operator": "gte",
              "value": 2
            }
          ],
          "actions": [
            {
              "type": "set",
              "target": "trading.cooldownBlocks",
              "value": 3
            },
            {
              "type": "reset",
              "target": "trade.consecutiveLosses",
              "value": 0
            }
          ],
          "metadata": {
            "version": 1,
            "createdAt": "2025-12-05T23:45:35.097Z",
            "updatedAt": "2025-12-05T23:45:35.097Z",
            "author": "system",
            "notes": [
              "Protects against streaks of losses"
            ],
            "testCoverage": 90
          }
        },
        {
          "id": "RULE-RSK-002",
          "name": "Daily Target Stop",
          "description": "Stop trading when daily P/L target reached",
          "category": "risk",
          "enabled": true,
          "priority": 0,
          "conditions": [
            {
              "field": "trading.pnlTotal",
              "operator": "gte",
              "value": "config.dailyTarget"
            }
          ],
          "actions": [
            {
              "type": "set",
              "target": "trading.dailyTargetReached",
              "value": true
            }
          ],
          "metadata": {
            "version": 1,
            "createdAt": "2025-12-05T23:45:35.097Z",
            "updatedAt": "2025-12-05T23:45:35.097Z",
            "author": "system",
            "notes": [
              "Prevents overtrading after reaching goal"
            ],
            "testCoverage": 95
          }
        },
        {
          "id": "RULE-DEACT-001",
          "name": "Pattern Break on Loss",
          "description": "Active pattern breaks (returns to observing) on loss",
          "category": "deactivation",
          "enabled": true,
          "priority": 1,
          "conditions": [
            {
              "field": "pattern.state",
              "operator": "eq",
              "value": "active"
            },
            {
              "field": "result.profit",
              "operator": "lt",
              "value": 0,
              "logic": "and"
            }
          ],
          "actions": [
            {
              "type": "set",
              "target": "pattern.state",
              "value": "observing"
            },
            {
              "type": "reset",
              "target": "pattern.cumulativeProfit",
              "value": 0
            },
            {
              "type": "reset",
              "target": "pattern.observationResults",
              "value": []
            }
          ],
          "metadata": {
            "version": 1,
            "createdAt": "2025-12-05T23:45:35.097Z",
            "updatedAt": "2025-12-05T23:45:35.097Z",
            "author": "system",
            "notes": [
              "Standard break behavior"
            ],
            "testCoverage": 90
          }
        },
        {
          "id": "RULE-ACT-004",
          "name": "AP5 Confirmation Activation",
          "description": "AP5 activates on 3rd block of opposite run when 2nd block >= 70%",
          "category": "activation",
          "enabled": true,
          "priority": 1,
          "conditions": [
            {
              "field": "pattern.name",
              "operator": "eq",
              "value": "AP5"
            },
            {
              "field": "runData.currentLength",
              "operator": "eq",
              "value": 3,
              "logic": "and"
            },
            {
              "field": "runData.previousLength",
              "operator": "gte",
              "value": 2,
              "logic": "and"
            },
            {
              "field": "blocks.secondOfRun.pct",
              "operator": "gte",
              "value": 70,
              "logic": "and"
            }
          ],
          "actions": [
            {
              "type": "set",
              "target": "pattern.state",
              "value": "active"
            }
          ],
          "metadata": {
            "version": 1,
            "createdAt": "2025-12-06T04:00:00.000Z",
            "updatedAt": "2025-12-06T04:00:00.000Z",
            "author": "system",
            "notes": [
              "AP5 confirms on 3rd block of opposite run",
              "70% check on 2nd block of the run"
            ],
            "testCoverage": 0
          }
        },
        {
          "id": "RULE-BRK-001",
          "name": "AP5 Break on Short Flip",
          "description": "AP5 breaks when flip happens with 2 or fewer blocks",
          "category": "break",
          "enabled": true,
          "priority": 1,
          "conditions": [
            {
              "field": "pattern.name",
              "operator": "eq",
              "value": "AP5"
            },
            {
              "field": "pattern.state",
              "operator": "eq",
              "value": "active",
              "logic": "and"
            },
            {
              "field": "runData.currentLength",
              "operator": "eq",
              "value": 1,
              "logic": "and"
            },
            {
              "field": "runData.previousLength",
              "operator": "lte",
              "value": 2,
              "logic": "and"
            }
          ],
          "actions": [
            {
              "type": "set",
              "target": "pattern.state",
              "value": "observing"
            },
            {
              "type": "reset",
              "target": "pattern.cumulativeProfit",
              "value": 0
            }
          ],
          "metadata": {
            "version": 1,
            "createdAt": "2025-12-06T04:00:00.000Z",
            "updatedAt": "2025-12-06T04:00:00.000Z",
            "author": "system",
            "notes": [
              "AP5 breaks when flip with â‰¤2 blocks"
            ],
            "testCoverage": 0
          }
        },
        {
          "id": "RULE-ACT-005",
          "name": "OZ Confirmation Activation",
          "description": "OZ activates on 3rd block of flip back when 1st block >= 70%",
          "category": "activation",
          "enabled": true,
          "priority": 1,
          "conditions": [
            {
              "field": "pattern.name",
              "operator": "eq",
              "value": "OZ"
            },
            {
              "field": "runData.currentLength",
              "operator": "eq",
              "value": 3,
              "logic": "and"
            },
            {
              "field": "runData.previousLength",
              "operator": "eq",
              "value": 1,
              "logic": "and"
            },
            {
              "field": "blocks.firstOfRun.pct",
              "operator": "gte",
              "value": 70,
              "logic": "and"
            }
          ],
          "actions": [
            {
              "type": "set",
              "target": "pattern.state",
              "value": "active"
            }
          ],
          "metadata": {
            "version": 1,
            "createdAt": "2025-12-06T04:00:00.000Z",
            "updatedAt": "2025-12-06T04:00:00.000Z",
            "author": "system",
            "notes": [
              "OZ confirms on 3rd block of flip back after single",
              "70% check on 1st block of the flip back run"
            ],
            "testCoverage": 0
          }
        },
        {
          "id": "RULE-BRK-002",
          "name": "OZ Break on Short Flip Back",
          "description": "OZ breaks when flip back is less than 3 blocks",
          "category": "break",
          "enabled": true,
          "priority": 1,
          "conditions": [
            {
              "field": "pattern.name",
              "operator": "eq",
              "value": "OZ"
            },
            {
              "field": "pattern.state",
              "operator": "eq",
              "value": "active",
              "logic": "and"
            },
            {
              "field": "runData.currentLength",
              "operator": "eq",
              "value": 1,
              "logic": "and"
            },
            {
              "field": "runData.previousLength",
              "operator": "lt",
              "value": 3,
              "logic": "and"
            }
          ],
          "actions": [
            {
              "type": "set",
              "target": "pattern.state",
              "value": "observing"
            },
            {
              "type": "reset",
              "target": "pattern.cumulativeProfit",
              "value": 0
            }
          ],
          "metadata": {
            "version": 1,
            "createdAt": "2025-12-06T04:00:00.000Z",
            "updatedAt": "2025-12-06T04:00:00.000Z",
            "author": "system",
            "notes": [
              "OZ breaks when flip back < 3 blocks"
            ],
            "testCoverage": 0
          }
        }
      ],
      "isDefault": true,
      "createdAt": "2025-12-05T23:45:35.097Z"
    }
  }
}